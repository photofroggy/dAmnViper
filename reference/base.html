
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. base module &mdash; dAmn Viper</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.59',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="dAmn Viper" href="../index.html" />
    <link rel="up" title="Package Reference" href="index.html" />
    <link rel="next" title="2. net module" href="net.html" />
    <link rel="prev" title="Package Reference" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="net.html" title="2. net module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Package Reference"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">dAmn Viper</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Package Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="base-module">
<h1>1. <tt class="docutils literal"><span class="pre">base</span></tt> module<a class="headerlink" href="#base-module" title="Permalink to this headline">¶</a></h1>
<p>This module provides the dAmnClient class, which acts as an API for
connecting to and interacting with deviantART.com&#8217;s chatrooms. This is
achieved using Twisted.</p>
<p><tt class="docutils literal"><span class="pre">dAmnClient</span></tt> is built on top of the <tt class="docutils literal"><span class="pre">Client</span></tt> class, which provides the
basic functionality required to connect to a dAmn server. The <tt class="docutils literal"><span class="pre">dAmnClient</span></tt>
class handles the server handshake and sets the right information for the
connection, so should be used instead of the <tt class="docutils literal"><span class="pre">Client</span></tt> class in most cases.</p>
<div class="section" id="ichatclient-basic-client-interface">
<h2>1.1. <tt class="docutils literal"><span class="pre">IChatClient</span></tt> - Basic client interface<a class="headerlink" href="#ichatclient-basic-client-interface" title="Permalink to this headline">¶</a></h2>
<span class="target" id="clientinterface"></span><dl class="class">
<dt id="dAmnViper.base.IChatClient">
<em class="property">class </em><tt class="descclassname">dAmnViper.base.</tt><tt class="descname">IChatClient</tt><a class="headerlink" href="#dAmnViper.base.IChatClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for client objects for dAmn-like servers.</p>
<p><strong>Note:</strong> <em>This object does not use zope.interface. I find z.i to be
somewhat needless except in the case where it saves a bit of typing.</em></p>
<p>Any client class which connects to a dAmn server or similar, using the
dAmnViper library, should implement this interface as a bare minimum.</p>
<p>All methods in this class raise a <tt class="docutils literal"><span class="pre">NotImplementedError</span></tt> exception if
they are not overridden. Note that <tt class="docutils literal"><span class="pre">startedConnecting</span></tt> is <em>not</em>
overridden in the <tt class="docutils literal"><span class="pre">ChatClient</span></tt> class, but is overridden in the
<tt class="docutils literal"><span class="pre">dAmnClient</span></tt> class.</p>
<dl class="method">
<dt id="dAmnViper.base.IChatClient.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the connection to the server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.connectionFailed">
<tt class="descname">connectionFailed</tt><big>(</big><em>connector</em>, <em>reason</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.connectionFailed" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when the client fails to connect.</p>
<p>Same as <tt class="docutils literal"><span class="pre">connectionLost</span></tt> and <tt class="docutils literal"><span class="pre">startedConnecting</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.connectionLost">
<tt class="descname">connectionLost</tt><big>(</big><em>connector</em>, <em>reason</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.connectionLost" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when the client loses its connection.</p>
<p>This method is called in a similar way that the
<tt class="docutils literal"><span class="pre">startedConnecting</span></tt> method is called.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.connectionMade">
<tt class="descname">connectionMade</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.connectionMade" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when we have made a connection with the server.</p>
<p>This method is invoked by a method with the same name in the
<a class="reference internal" href="net.html#dAmnViper.net.ChatProtocol" title="dAmnViper.net.ChatProtocol"><tt class="xref py py-class docutils literal"><span class="pre">ChatProtocol</span></tt></a> object being
used for the connection.</p>
<p>Clients should use this method to do anything which is required on
making a connection, such as sending a handshake to the server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.dataReceived">
<tt class="descname">dataReceived</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.dataReceived" title="Permalink to this definition">¶</a></dt>
<dd><p>We have received data from the server. If you need to do something
now, do it.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.handle_pkt">
<tt class="descname">handle_pkt</tt><big>(</big><em>packet</em>, <em>stamp</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.handle_pkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a packet received from the chat server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.makeConnection">
<tt class="descname">makeConnection</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.makeConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a connection to a chat server.</p>
<p>This method should attempt to open a connection to a chat server
using <a class="reference internal" href="net.html#dAmnViper.net.ConnectionFactory" title="dAmnViper.net.ConnectionFactory"><tt class="xref py py-class docutils literal"><span class="pre">ConnectionFactory</span></tt></a> object as the connection&#8217;s
client factory.</p>
<p>This method should be called by the <tt class="docutils literal"><span class="pre">start</span></tt> method and the
<tt class="docutils literal"><span class="pre">persist</span></tt> method.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.persist">
<tt class="descname">persist</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the client should make another attempt to connect to
the chat server.</p>
<p>Given the current state of the client object when <tt class="docutils literal"><span class="pre">persist</span></tt> is
called, this method should determine whether or not the client
should make another attempt at connecting to the chat server.</p>
<p>The client object should use attributes to help in deciding this,
as this method does not take any relevant input.</p>
<p>This method should call <tt class="docutils literal"><span class="pre">makeConnection</span></tt> directly if the client
is going to connect again.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.send">
<tt class="descname">send</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send data to the chat server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.set_protocol">
<tt class="descname">set_protocol</tt><big>(</big><em>protocol=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.set_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <a class="reference internal" href="net.html#dAmnViper.net.ChatProtocol" title="dAmnViper.net.ChatProtocol"><tt class="xref py py-class docutils literal"><span class="pre">ChatProtocol</span></tt></a>
object being used by the client.</p>
<p>This method is called by the <a class="reference internal" href="net.html#dAmnViper.net.ConnectionFactory" title="dAmnViper.net.ConnectionFactory"><tt class="xref py py-class docutils literal"><span class="pre">ConnectionFactory</span></tt></a> object when a protocol object is
created for the connection. The client itself should call this
method with <tt class="xref docutils literal"><span class="pre">None</span></tt> as the protocol when the client loses a
connection or fails to connect. This method should, in turn, call
the <tt class="docutils literal"><span class="pre">persist</span></tt> method in the client object.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.start">
<tt class="descname">start</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the client.</p>
<p>This method should perform any required start-up activities that
need to be performed before first attempting to connect to a chat
server.</p>
<p>This method should eventually call <tt class="docutils literal"><span class="pre">makeConnection</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.IChatClient.startedConnecting">
<tt class="descname">startedConnecting</tt><big>(</big><em>connector</em><big>)</big><a class="headerlink" href="#dAmnViper.base.IChatClient.startedConnecting" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when the client is starting to connect.</p>
<p>This method is called by the <a class="reference internal" href="net.html#dAmnViper.net.ConnectionFactory" title="dAmnViper.net.ConnectionFactory"><tt class="xref py py-class docutils literal"><span class="pre">ConnectionFactory</span></tt></a> method of the same name, which
is called by twisted when twisted is starting to connect to the
chat server.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="chatclient-the-base-chat-client-api">
<h2>1.2. <tt class="docutils literal"><span class="pre">ChatClient</span></tt> - The base chat client API<a class="headerlink" href="#chatclient-the-base-chat-client-api" title="Permalink to this headline">¶</a></h2>
<span class="target" id="baseclient"></span><dl class="class">
<dt id="dAmnViper.base.ChatClient">
<em class="property">class </em><tt class="descclassname">dAmnViper.base.</tt><tt class="descname">ChatClient</tt><big>(</big><em>stdout=None</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is a client for llama-like chat servers.</p>
<p>The llama project can be seen here:</p>
<div class="highlight-python"><pre>http://code.google.com/p/project-llama-server/
http://llamaserver.blogspot.com/</pre>
</div>
<p>Applications using this class should extend it and override the
<cite>startedConnecting</cite> and <cite>teardown</cite> methods. If you are simply
connecting to a dAmn server, you may want to use the
<a class="reference internal" href="#dAmnViper.base.dAmnClient" title="dAmnViper.base.dAmnClient"><tt class="xref py py-class docutils literal"><span class="pre">dAmnClient</span> <span class="pre">class</span></tt></a> instead.</p>
</dd></dl>

<div class="section" id="main-methods">
<h3>1.2.1. Main methods<a class="headerlink" href="#main-methods" title="Permalink to this headline">¶</a></h3>
<p>These methods should be a point of interest in understanding how
the class starts up and handles the connection.</p>
<dl class="method">
<dt id="dAmnViper.base.ChatClient.init">
<tt class="descclassname">ChatClient.</tt><tt class="descname">init</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwrite this method if you need to do anything
when an instance of this class is created.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.populate_objects">
<tt class="descclassname">ChatClient.</tt><tt class="descname">populate_objects</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.populate_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate our objects that are used to store information and stuff.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.nullflags">
<tt class="descclassname">ChatClient.</tt><tt class="descname">nullflags</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.nullflags" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all status flags in this client.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.set_protocol">
<tt class="descclassname">ChatClient.</tt><tt class="descname">set_protocol</tt><big>(</big><em>protocol=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.set_protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the given IO protocol.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.start">
<tt class="descclassname">ChatClient.</tt><tt class="descname">start</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the client.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.makeConnection">
<tt class="descclassname">ChatClient.</tt><tt class="descname">makeConnection</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.makeConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens a connection to a dAmn-like server.</p>
<p>Raises a <tt class="docutils literal"><span class="pre">ValueError</span></tt> if <tt class="docutils literal"><span class="pre">ChatClient.user.username</span></tt> or
<tt class="docutils literal"><span class="pre">ChatClient.user.token</span></tt> is <tt class="xref docutils literal"><span class="pre">None</span></tt>.</p>
<p>Raises a <tt class="docutils literal"><span class="pre">ValueError</span></tt> if any of the <tt class="docutils literal"><span class="pre">ChatClient.CONST</span></tt>
attributes are <tt class="xref docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.connectionLost">
<tt class="descclassname">ChatClient.</tt><tt class="descname">connectionLost</tt><big>(</big><em>connector</em>, <em>reason</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.connectionLost" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when we lose our connection.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.connectionFailed">
<tt class="descclassname">ChatClient.</tt><tt class="descname">connectionFailed</tt><big>(</big><em>connector</em>, <em>reason</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.connectionFailed" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when we fail to connect.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.connectionMade">
<tt class="descclassname">ChatClient.</tt><tt class="descname">connectionMade</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.connectionMade" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when we have made a connection.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.persist">
<tt class="descclassname">ChatClient.</tt><tt class="descname">persist</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.persist" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine what we should do when we have fully lost our connection
to the server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.teardown">
<tt class="descclassname">ChatClient.</tt><tt class="descname">teardown</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.teardown" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this method to do stuff when the client gives up.
It is a good idea to use this method to call reactor.stop().</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.mainloop">
<tt class="descclassname">ChatClient.</tt><tt class="descname">mainloop</tt><big>(</big><em>args</em>, <em>kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.mainloop" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the client&#8217;s main loop.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.on_loop">
<tt class="descclassname">ChatClient.</tt><tt class="descname">on_loop</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.on_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwrite this if you need to do anything on the main application loop.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.timedout">
<tt class="descclassname">ChatClient.</tt><tt class="descname">timedout</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.timedout" title="Permalink to this definition">¶</a></dt>
<dd><p>Timeout detected.</p>
<p>If this method gets called, then the client has not received
any data for 2 minutes. Send a pong to test the connection.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.close">
<tt class="descclassname">ChatClient.</tt><tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This is how we close our connection!</p>
</dd></dl>

</div>
<div class="section" id="connection-events">
<h3>1.2.2. Connection events<a class="headerlink" href="#connection-events" title="Permalink to this headline">¶</a></h3>
<p>As well as the above methods, there are dummy methods which are called for
different events to do with the connection. These methods can be overwritten
if your client needs to do anything specific on those events. Those methods are
as follows:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">on_connection_start</span></tt> - Parameters: connector</li>
<li><tt class="docutils literal"><span class="pre">on_connection_lost</span></tt> - Parameters: connector, reason</li>
<li><tt class="docutils literal"><span class="pre">on_connection_failed</span></tt> - Parameters: connector, reason</li>
<li><tt class="docutils literal"><span class="pre">on_connection_made</span></tt> - No input.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sending-data">
<h3>1.1.3. Sending data<a class="headerlink" href="#sending-data" title="Permalink to this headline">¶</a></h3>
<p>These methods are used to send data to the server. You should use these
methods if you want to interact with dAmn.</p>
<dl class="method">
<dt id="dAmnViper.base.ChatClient.send">
<tt class="descclassname">ChatClient.</tt><tt class="descname">send</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Send data to dAmn!</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.raw">
<tt class="descclassname">ChatClient.</tt><tt class="descname">raw</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a raw dAmn packet.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pong">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pong</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pong" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a pong packet to the server</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.handshake">
<tt class="descclassname">ChatClient.</tt><tt class="descname">handshake</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.handshake" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a handshake to the server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.login">
<tt class="descclassname">ChatClient.</tt><tt class="descname">login</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.login" title="Permalink to this definition">¶</a></dt>
<dd><p>Send our login packet. Set the loggingin flag to true.</p>
<p>Raises a <tt class="docutils literal"><span class="pre">ValueError</span></tt> if <tt class="docutils literal"><span class="pre">ChatClient.user.username</span></tt> or
<tt class="docutils literal"><span class="pre">ChatClient.user.token</span></tt> is <tt class="xref docutils literal"><span class="pre">None</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.join">
<tt class="descclassname">ChatClient.</tt><tt class="descname">join</tt><big>(</big><em>ns</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a join packet to dAmn.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.part">
<tt class="descclassname">ChatClient.</tt><tt class="descname">part</tt><big>(</big><em>ns</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.part" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a part packet to dAmn.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.say">
<tt class="descclassname">ChatClient.</tt><tt class="descname">say</tt><big>(</big><em>ns</em>, <em>message</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.say" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a message to a dAmn channel namespace.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.npmsg">
<tt class="descclassname">ChatClient.</tt><tt class="descname">npmsg</tt><big>(</big><em>ns</em>, <em>message</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.npmsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a non-parsed message to a dAmn channel namespace.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.action">
<tt class="descclassname">ChatClient.</tt><tt class="descname">action</tt><big>(</big><em>ns</em>, <em>message</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.action" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an action to a dAmn channel namespace.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.me">
<tt class="descclassname">ChatClient.</tt><tt class="descname">me</tt><big>(</big><em>ns</em>, <em>message</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.me" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just another way to do an action.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.promote">
<tt class="descclassname">ChatClient.</tt><tt class="descname">promote</tt><big>(</big><em>ns</em>, <em>user</em>, <em>pc=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.promote" title="Permalink to this definition">¶</a></dt>
<dd><p>Promote a user in a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.demote">
<tt class="descclassname">ChatClient.</tt><tt class="descname">demote</tt><big>(</big><em>ns</em>, <em>user</em>, <em>pc=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.demote" title="Permalink to this definition">¶</a></dt>
<dd><p>Demote a user in a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.kick">
<tt class="descclassname">ChatClient.</tt><tt class="descname">kick</tt><big>(</big><em>ns</em>, <em>user</em>, <em>r=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.kick" title="Permalink to this definition">¶</a></dt>
<dd><p>Kick a user out of a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.ban">
<tt class="descclassname">ChatClient.</tt><tt class="descname">ban</tt><big>(</big><em>ns</em>, <em>user</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.ban" title="Permalink to this definition">¶</a></dt>
<dd><p>Ban a user from a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.unban">
<tt class="descclassname">ChatClient.</tt><tt class="descname">unban</tt><big>(</big><em>ns</em>, <em>user</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.unban" title="Permalink to this definition">¶</a></dt>
<dd><p>Unban someone from a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.get">
<tt class="descclassname">ChatClient.</tt><tt class="descname">get</tt><big>(</big><em>ns</em>, <em>p</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a property for a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.set">
<tt class="descclassname">ChatClient.</tt><tt class="descname">set</tt><big>(</big><em>ns</em>, <em>p</em>, <em>val</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a property for a dAmn channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.admin">
<tt class="descclassname">ChatClient.</tt><tt class="descname">admin</tt><big>(</big><em>ns</em>, <em>command</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.admin" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an admin command to a dAmn channel. No need for multiple methods here.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.disconnect">
<tt class="descclassname">ChatClient.</tt><tt class="descname">disconnect</tt><big>(</big><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a disconnect packet to the dAmn server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.kill">
<tt class="descclassname">ChatClient.</tt><tt class="descname">kill</tt><big>(</big><em>ns</em>, <em>r=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a kill packet to the dAmn server.</p>
</dd></dl>

</div>
<div class="section" id="receiving-data">
<h3>1.2.4. Receiving data<a class="headerlink" href="#receiving-data" title="Permalink to this headline">¶</a></h3>
<p>These methods are used to handle incoming data.</p>
<dl class="method">
<dt id="dAmnViper.base.ChatClient.handle_pkt">
<tt class="descclassname">ChatClient.</tt><tt class="descname">handle_pkt</tt><big>(</big><em>packet</em>, <em>stamp</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.handle_pkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle packets as they come in.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_generic">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_generic</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_generic" title="Permalink to this definition">¶</a></dt>
<dd><p>We have received a packet!</p>
<p>Override this method to do stuff whenever a packet is
received. If you want to do stuff when a specific packet is
received, define a new <tt class="docutils literal"><span class="pre">pkt_*</span></tt> method for that packet.</p>
<p>If the method you are defining already exists, then you
should call the original method from your own definition, so
that the client does not break.</p>
<p>Here, the method is given a dict as returned by the
<a class="reference internal" href="parse.html#dAmnViper.parse.ProtocolParser" title="dAmnViper.parse.ProtocolParser"><tt class="xref py py-class docutils literal"><span class="pre">ProtocolParser</span></tt></a>
method <tt class="docutils literal"><span class="pre">mapper</span></tt>. Other <tt class="docutils literal"><span class="pre">pkt_*</span></tt> methods are only given
the data under the <tt class="docutils literal"><span class="pre">args</span></tt> key of the dict returned by the
<tt class="docutils literal"><span class="pre">mapper</span></tt> method.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_unknown">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_unknown</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_unknown" title="Permalink to this definition">¶</a></dt>
<dd><p>We received something unexpected. Oh well.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_login">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_login</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_login" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a login packet.</p>
<p>When we receive a login packet, we need to determine whether
the login was successful or not, and act based on that.</p>
<p>This method closes the client if the login failed.
Otherwise, the channels listed in the <tt class="docutils literal"><span class="pre">autojoin</span></tt> attribute
are joined.</p>
<p>This method is essential for connecting to dAmn properly.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_join">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_join</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_join" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a join packet.</p>
<p>This is sent by the server when the client tries to join a
channel on the server.</p>
<p>If the join was successful, a <a class="reference internal" href="data.html#dAmnViper.data.Channel" title="dAmnViper.data.Channel"><tt class="xref py py-class docutils literal"><span class="pre">Channel</span> <span class="pre">object</span></tt></a> is created for the channel and
stored in the <tt class="docutils literal"><span class="pre">channel</span></tt> attribute of the client.</p>
<p>If the join failed, the client disconnects if there are no
other joined channels. (<tt class="docutils literal"><span class="pre">naive</span></tt>)</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_part">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_part</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a part packet.</p>
<p>Similar to <tt class="docutils literal"><span class="pre">pkt_join</span></tt>. This method determines whether or
not the client is being kicked off the server.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_property">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_property</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a channel property packet.</p>
<p>This method makes sure that the information received is
stored in the right place.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_recv_join">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_recv_join</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_recv_join" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a recv_join packet.</p>
<p>This happens when a user joins a channel in which the client
is also present.</p>
<p>This method simply stores information about the user that
just joined.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_recv_part">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_recv_part</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_recv_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a recv_part packet.</p>
<p>This happens when a user leaves a channel in which the
client is present.</p>
<p>Here, we remove any records of the user being in the channel.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_recv_kicked">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_recv_kicked</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_recv_kicked" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a recv_kick packet.</p>
<p>Similar to the <tt class="docutils literal"><span class="pre">pkt_recv_part</span></tt> method.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_recv_privchg">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_recv_privchg</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_recv_privchg" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a recv_privchg packet.</p>
<p>This happens when a user&#8217;s privclass is changed. All we do
here is make sure the user is recorded as being in that
privclass.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_kicked">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_kicked</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_kicked" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a kicked packet.</p>
<p>This happens when the client is kicked from a channel.</p>
<p>Here we automatically rejoin the channel if we are permitted
to do so.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.pkt_disconnect">
<tt class="descclassname">ChatClient.</tt><tt class="descname">pkt_disconnect</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.pkt_disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a disconnect packet from the server.</p>
<p>Here we make sure the client does the right thing when a
disconnect happens.</p>
<p>This method is required for the client to work as expected.</p>
</dd></dl>

</div>
<div class="section" id="utility-methods">
<h3>1.2.5. Utility methods<a class="headerlink" href="#utility-methods" title="Permalink to this headline">¶</a></h3>
<p>These methods are general purpose methods which can be used in your
application.</p>
<dl class="method">
<dt id="dAmnViper.base.ChatClient.format_ns">
<tt class="descclassname">ChatClient.</tt><tt class="descname">format_ns</tt><big>(</big><em>ns</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.format_ns" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes a dAmn channel name and formats it as a raw
dAmn namespace.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.deform_ns">
<tt class="descclassname">ChatClient.</tt><tt class="descname">deform_ns</tt><big>(</big><em>ns</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.deform_ns" title="Permalink to this definition">¶</a></dt>
<dd><p>This does the opposite of format_ns()</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.logger">
<tt class="descclassname">ChatClient.</tt><tt class="descname">logger</tt><big>(</big><em>msg</em>, <em>ns=None</em>, <em>showns=True</em>, <em>mute=False</em>, <em>pkt=None</em>, <em>ts=None</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output to stdout.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.new_logger">
<tt class="descclassname">ChatClient.</tt><tt class="descname">new_logger</tt><big>(</big><em>ns=None</em>, <em>showns=True</em>, <em>mute=False</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.new_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a wrapped logger method.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.ChatClient.get_write_pair">
<tt class="descclassname">ChatClient.</tt><tt class="descname">get_write_pair</tt><big>(</big><em>showns=False</em><big>)</big><a class="headerlink" href="#dAmnViper.base.ChatClient.get_write_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pair of wrapped logger methods.</p>
</dd></dl>

</div>
</div>
<div class="section" id="damnclient-basic-damn-client-class">
<h2>1.3. <tt class="docutils literal"><span class="pre">dAmnClient</span></tt> - Basic dAmn client class<a class="headerlink" href="#damnclient-basic-damn-client-class" title="Permalink to this headline">¶</a></h2>
<span class="target" id="damnclient"></span><dl class="class">
<dt id="dAmnViper.base.dAmnClient">
<em class="property">class </em><tt class="descclassname">dAmnViper.base.</tt><tt class="descname">dAmnClient</tt><big>(</big><em>stdout=None</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#dAmnViper.base.dAmnClient" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides an easy to use API for connecting to dAmn, and for
interacting with the server.</p>
<p>This class inherits much of its behaviour from the <tt class="xref py py-class docutils literal"><span class="pre">Client</span>
<span class="pre">class</span></tt>. This class has been made to cater more
closely for dAmn servers. The Client class can be used to make clients
which connect to llama based servers. In fact, with some slight
modifications, this class could also connect to llama servers.</p>
<p>Applications using this class should extend the class to add in
some basic functionality so that it works as they expect. The
class can be made to work properly with only minor modifications
as shown here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="kn">import</span> <span class="n">reactor</span>
<span class="kn">from</span> <span class="nn">dAmnViper.base</span> <span class="kn">import</span> <span class="n">dAmnSock</span>

<span class="n">dAmn</span> <span class="o">=</span> <span class="n">dAmnClient</span><span class="p">()</span>    

<span class="n">dAmn</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="s">&#39;username&#39;</span>
<span class="n">dAmn</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="s">&#39;authtoken&#39;</span>
<span class="n">dAmn</span><span class="o">.</span><span class="n">autojoin</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Botdom&#39;</span><span class="p">]</span>

<span class="n">dAmn</span><span class="o">.</span><span class="n">teardown</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">reactor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="n">dAmn</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">if</span> <span class="n">dAmn</span><span class="o">.</span><span class="n">flag</span><span class="o">.</span><span class="n">connecting</span><span class="p">:</span>
    <span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">teardown</span></tt> callback needs to be defined or the application
will hang when the connection to dAmn is lost.</p>
<p>A way to remove the need to check the <tt class="docutils literal"><span class="pre">dAmnClient.flag.connecting</span></tt>
flag is to define your own <tt class="docutils literal"><span class="pre">on_connection_start</span></tt> method on the
object, and using this to call <tt class="docutils literal"><span class="pre">reactor.run()</span></tt>.</p>
<dl class="method">
<dt id="dAmnViper.base.dAmnClient.pkt_dAmnServer">
<tt class="descname">pkt_dAmnServer</tt><big>(</big><em>event</em><big>)</big><a class="headerlink" href="#dAmnViper.base.dAmnClient.pkt_dAmnServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Received a dAmnServer packet.</p>
<p>This method calls the <tt class="docutils literal"><span class="pre">login</span></tt> method of this class and
sets the <tt class="docutils literal"><span class="pre">shaking</span></tt> flag to <tt class="xref docutils literal"><span class="pre">False</span></tt>.</p>
<p>This method is essential for connecting to dAmn properly.</p>
</dd></dl>

<dl class="method">
<dt id="dAmnViper.base.dAmnClient.startedConnecting">
<tt class="descname">startedConnecting</tt><big>(</big><em>connector</em><big>)</big><a class="headerlink" href="#dAmnViper.base.dAmnClient.startedConnecting" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when we have started connecting.</p>
<p>All this method does is display a message in <tt class="docutils literal"><span class="pre">stdout</span></tt>, set the
<tt class="docutils literal"><span class="pre">connecting</span></tt> flag to <tt class="xref docutils literal"><span class="pre">True</span></tt>, and calls <tt class="docutils literal"><span class="pre">on_connection_start</span></tt>
to allow any sub-classes or custom clients to perform any actions
when the client starts connecting to dAmn.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. <tt class="docutils literal"><span class="pre">base</span></tt> module</a><ul>
<li><a class="reference internal" href="#ichatclient-basic-client-interface">1.1. <tt class="docutils literal"><span class="pre">IChatClient</span></tt> - Basic client interface</a></li>
<li><a class="reference internal" href="#chatclient-the-base-chat-client-api">1.2. <tt class="docutils literal"><span class="pre">ChatClient</span></tt> - The base chat client API</a><ul>
<li><a class="reference internal" href="#main-methods">1.2.1. Main methods</a></li>
<li><a class="reference internal" href="#connection-events">1.2.2. Connection events</a></li>
<li><a class="reference internal" href="#sending-data">1.1.3. Sending data</a></li>
<li><a class="reference internal" href="#receiving-data">1.2.4. Receiving data</a></li>
<li><a class="reference internal" href="#utility-methods">1.2.5. Utility methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#damnclient-basic-damn-client-class">1.3. <tt class="docutils literal"><span class="pre">dAmnClient</span></tt> - Basic dAmn client class</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Package Reference</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="net.html"
                        title="next chapter">2. <tt class="docutils literal"><span class="pre">net</span></tt> module</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/reference/base.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="net.html" title="2. net module"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Package Reference"
             >previous</a> |</li>
        <li><a href="../index.html">dAmn Viper</a> &raquo;</li>
          <li><a href="index.html" >Package Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, photofroggy.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>